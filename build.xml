<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." default="compile-and-run" name="arrows-and-circles">
  <property environment="env"/>
  
  <!--Manually set properties-->
  <property name="src.dir" value="${basedir}/src"/>
  <property name="lib.dir" value="${basedir}/lib"/>
  <property name="bin.dir" value="${basedir}/bin"/>
  <property name="build.dir" value="${basedir}/build"/>
  
  <!--Properties generated by Eclipse-->
  <property name="junit.output.dir" value="junit"/>
  <property name="debuglevel" value="source,lines,vars"/>
  <property name="target" value="1.6"/>
  <property name="source" value="1.6"/>
  <path id="arrows-and-circles.classpath">
    <pathelement location="${bin.dir}"/>
    <pathelement location="${lib.dir}/google-gson-stream-2.1.jar"/>
    <pathelement location="${lib.dir}/junit-4.11-SNAPSHOT-20120416-1530.jar"/>
  </path>
  
  <!--Initiate the compilation-->
  <target name="init">
    <tstamp/>
    <mkdir dir="${bin.dir}"/>
    <copy includeemptydirs="false" todir="${bin.dir}">
      <fileset dir="${src.dir}">
	<exclude name="**/*.java"/>
      </fileset>
    </copy>
  </target>
  
  <!--Clean and built files-->
  <target name="clean">
    <delete dir="${bin.dir}"/>
    <delete dir="${build.dir}"/>
    <delete dir="${junit.output.dir}"/>
  </target>
  
  <!--Compile the project-->
  <target depends="init" name="compile">
    <echo message="${ant.project.name}: ${ant.file}"/>
    <javac debug="true" debuglevel="${debuglevel}" destdir="${bin.dir}" includeantruntime="false" source="${source}" target="${target}">
      <src path="${src.dir}"/>
      <classpath refid="arrows-and-circles.classpath"/>
    </javac>
  </target>
  
  <!--Run the program-->
  <target name="run">
    <java classname="frontend.MainFrame" failonerror="true" fork="yes">
      <classpath refid="arrows-and-circles.classpath"/>
    </java>
  </target>
  
  <!--Compile and run the program-->
  <target depends="compile" name="compile-and-run">
    <java classname="frontend.MainFrame" failonerror="true" fork="yes">
      <classpath refid="arrows-and-circles.classpath"/>
    </java>
  </target>

  <!--Build JAR file-->
  <target depends="compile" name="build">
    <mkdir dir="${build.dir}"/>
    <jar jarfile="${build.dir}/arrows-and-circles-${DSTAMP}.jar" basedir="${bin.dir}">
      <manifest>
	<attribute name="Main-Class" value="frontend.MainFrame"/>
      </manifest>
      <zipgroupfileset dir="${lib.dir}" includes="*.jar" />
    </jar>
  </target>
  
  <!--Run the testing on diagram-->
  <target name="testing-diagram">
    <mkdir dir="${junit.output.dir}"/>
    <junit fork="yes" printsummary="withOutAndErr">
      <formatter type="xml"/>
      <test name="testing.DiagramTest" todir="${junit.output.dir}"/>
      <classpath refid="arrows-and-circles.classpath"/>
    </junit>
  </target>
</project>

